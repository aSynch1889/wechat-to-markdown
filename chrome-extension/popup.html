<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      width: 450px;
      max-height: 600px;
      padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      overflow-y: auto;
    }
    
    h2 {
      margin: 0 0 15px 0;
      font-size: 18px;
      color: #333;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 15px;
      border-bottom: 2px solid #e5e7eb;
    }
    
    .tab {
      padding: 8px 16px;
      background: none;
      border: none;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      color: #6b7280;
      transition: all 0.2s;
    }
    
    .tab.active {
      color: #1a73e8;
      border-bottom-color: #1a73e8;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    button {
      width: 100%;
      padding: 12px;
      background: #1a73e8;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
      font-weight: 500;
      transition: background 0.2s;
      margin-bottom: 8px;
    }
    
    button:hover:not(:disabled) {
      background: #1557b0;
    }
    
    button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    
    .btn-secondary {
      background: #6366f1;
    }
    
    .btn-secondary:hover:not(:disabled) {
      background: #4f46e5;
    }
    
    .btn-warning {
      background: #f59e0b;
    }
    
    .btn-warning:hover:not(:disabled) {
      background: #d97706;
    }
    
    #status {
      margin-top: 15px;
      padding: 10px;
      border-radius: 6px;
      font-size: 13px;
      display: none;
    }
    
    .success {
      background: #e8f5e9;
      color: #2e7d32;
      border: 1px solid #81c784;
    }
    
    .error {
      background: #ffebee;
      color: #c62828;
      border: 1px solid #ef5350;
    }
    
    .info {
      background: #e3f2fd;
      color: #1565c0;
      border: 1px solid #64b5f6;
    }
    
    .warning {
      background: #fff3e0;
      color: #e65100;
      border: 1px solid #ffb74d;
    }
    
    .batch-section {
      margin-top: 15px;
    }
    
    .url-input {
      width: 100%;
      padding: 10px;
      border: 2px solid #e5e7eb;
      border-radius: 6px;
      font-size: 13px;
      margin-bottom: 8px;
      font-family: inherit;
    }
    
    .url-input:focus {
      outline: none;
      border-color: #1a73e8;
    }
    
    textarea.url-input {
      min-height: 100px;
      resize: vertical;
    }
    
    .hint {
      font-size: 12px;
      color: #6b7280;
      margin-top: 5px;
      margin-bottom: 10px;
    }
    
    .article-list {
      max-height: 350px;
      overflow-y: auto;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      margin: 10px 0;
    }
    
    .article-item {
      padding: 10px;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      align-items: start;
      gap: 10px;
      transition: background 0.2s;
    }
    
    .article-item:hover {
      background: #f9fafb;
    }
    
    .article-item:last-child {
      border-bottom: none;
    }
    
    .article-checkbox {
      margin-top: 2px;
      cursor: pointer;
    }
    
    .article-info {
      flex: 1;
      min-width: 0;
    }
    
    .article-title {
      font-size: 13px;
      font-weight: 500;
      color: #333;
      margin-bottom: 4px;
      word-wrap: break-word;
    }
    
    .article-meta {
      font-size: 11px;
      color: #6b7280;
    }
    
    .select-controls {
      display: flex;
      gap: 8px;
      margin-bottom: 10px;
    }
    
    .select-controls button {
      flex: 1;
      padding: 6px;
      font-size: 12px;
      background: #f3f4f6;
      color: #374151;
    }
    
    .select-controls button:hover {
      background: #e5e7eb;
    }
    
    .loading {
      text-align: center;
      padding: 20px;
      color: #6b7280;
    }
    
    .loading::after {
      content: '...';
      animation: dots 1.5s steps(4, end) infinite;
    }
    
    @keyframes dots {
      0%, 20% { content: '.'; }
      40% { content: '..'; }
      60%, 100% { content: '...'; }
    }
    
    .account-info {
      padding: 12px;
      background: #f3f4f6;
      border-radius: 6px;
      margin-bottom: 10px;
    }
    
    .account-name {
      font-size: 14px;
      font-weight: 600;
      color: #333;
      margin-bottom: 4px;
    }
    
    .account-meta {
      font-size: 12px;
      color: #6b7280;
    }
    
    .progress-bar {
      width: 100%;
      height: 6px;
      background: #e5e7eb;
      border-radius: 3px;
      overflow: hidden;
      margin: 10px 0;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #1a73e8, #4f46e5);
      transition: width 0.3s;
    }
    
    .progress-text {
      font-size: 12px;
      color: #6b7280;
      text-align: center;
      margin-top: 5px;
    }
    
    .instruction-box {
      background: #fef3c7;
      border: 1px solid #fbbf24;
      border-radius: 6px;
      padding: 12px;
      margin-bottom: 10px;
      font-size: 13px;
      line-height: 1.6;
    }
    
    .instruction-box strong {
      color: #92400e;
    }
    
    .step-list {
      margin: 8px 0;
      padding-left: 20px;
    }
    
    .step-list li {
      margin: 4px 0;
      color: #78350f;
    }
  </style>
</head>
<body>
  <h2>ğŸ“„ å¾®ä¿¡è½¬Markdown</h2>
  
  <div class="tabs">
    <button class="tab active" data-tab="single">å•ç¯‡</button>
    <button class="tab" data-tab="batch">æ‰¹é‡</button>
    <button class="tab" data-tab="account">å…¬ä¼—å·</button>
  </div>
  
  <!-- å•ç¯‡è½¬æ¢ -->
  <div class="tab-content active" id="single">
    <button id="convertBtn">è½¬æ¢å½“å‰é¡µé¢</button>
  </div>
  
  <!-- æ‰¹é‡è½¬æ¢ -->
  <div class="tab-content" id="batch">
    <textarea 
      id="batchUrls" 
      class="url-input" 
      placeholder="ç²˜è´´å¤šä¸ªæ–‡ç« é“¾æ¥ï¼Œæ¯è¡Œä¸€ä¸ª"
    ></textarea>
    <p class="hint">ğŸ’¡ æ¯è¡Œè¾“å…¥ä¸€ä¸ªæ–‡ç« é“¾æ¥ï¼Œæˆ–ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ä»å‰ªè´´æ¿ç²˜è´´</p>
    <button id="pasteFromClipboardBtn" style="margin-bottom: 10px; width: 100%;">ğŸ“‹ ä»å‰ªè´´æ¿ç²˜è´´</button>
    <button id="batchConvertBtn">å¼€å§‹æ‰¹é‡è½¬æ¢</button>
  </div>
  
  <!-- å…¬ä¼—å·å†å²æ–‡ç«  -->
  <div class="tab-content" id="account">
    <div class="instruction-box">
      <strong>ğŸ“– ä½¿ç”¨è¯´æ˜ï¼š</strong>
      <ol class="step-list">
        <li><strong>æ–¹æ¡ˆ1ï¼ˆæ¨èï¼‰</strong>ï¼šåœ¨æ–‡ç« é¡µé¢ç‚¹å‡»"ä»å½“å‰é¡µé¢æå–é“¾æ¥"</li>
        <li><strong>æ–¹æ¡ˆ2</strong>ï¼šæ‰‹åŠ¨è¾“å…¥å†å²æ–‡ç« é¡µé¢é“¾æ¥ï¼Œç„¶åç‚¹å‡»"è·å–æ–‡ç« åˆ—è¡¨"</li>
        <li><strong>æ–¹æ¡ˆ3</strong>ï¼šåœ¨å¾®ä¿¡ä¸­æ‰“å¼€å†å²æ–‡ç« é¡µé¢ï¼Œç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œç‚¹å‡»"è·å–æ–‡ç« åˆ—è¡¨"</li>
        <li>å‹¾é€‰éœ€è¦çš„æ–‡ç« ï¼Œæ‰¹é‡ä¸‹è½½</li>
      </ol>
    </div>
    
    <button id="extractFromCurrentPageBtn" class="btn-primary">ğŸ” ä»å½“å‰é¡µé¢æå–é“¾æ¥</button>
    <button id="openHistoryBtn" class="btn-warning">ğŸ“± æ‰“å¼€å†å²æ–‡ç« é¡µé¢</button>
    <button id="fetchAccountBtn" class="btn-secondary">ğŸ“‹ è·å–æ–‡ç« åˆ—è¡¨</button>
    
    <div style="margin-top: 10px;">
      <label style="display: block; margin-bottom: 5px; font-size: 12px; color: #666;">æˆ–æ‰‹åŠ¨è¾“å…¥å†å²æ–‡ç« é¡µé¢é“¾æ¥ï¼š</label>
      <input type="text" id="historyPageUrl" class="url-input" placeholder="ç²˜è´´å†å²æ–‡ç« é¡µé¢é“¾æ¥ï¼ˆå¯é€‰ï¼‰" style="width: 100%; padding: 8px; margin-bottom: 5px;">
    </div>
    
    <div id="accountInfo" style="display: none;"></div>
    <div id="articleList" style="display: none;">
      <div class="select-controls">
        <button id="selectAllBtn">å…¨é€‰</button>
        <button id="selectNoneBtn">å–æ¶ˆ</button>
        <button id="selectInvertBtn">åé€‰</button>
      </div>
      <div class="article-list" id="articleListContent"></div>
      <button id="downloadSelectedBtn">ä¸‹è½½é€‰ä¸­æ–‡ç« </button>
    </div>
    <div id="loadingArticles" class="loading" style="display: none;">æ­£åœ¨è·å–æ–‡ç« åˆ—è¡¨</div>
  </div>
  
  <!-- è¿›åº¦æ¡ -->
  <div id="progressSection" style="display: none;">
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>
    <div class="progress-text" id="progressText"></div>
  </div>
  
  <div id="status"></div>
  
  <script src="popup.js"></script>
</body>
</html>